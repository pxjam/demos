!function(){var t,e=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire01a7,i=e("5rLfZ"),o=(t=i())&&t.__esModule?t.default:t,s=e("6GgW6"),a=e("7fPRq");i(),s();var n=[{firstCubeSize:55,cubesCount:15,duplicateFactor:.4,duplicateMethod:"sum",backfaceVisible:!0,autorotate:!0,autorotateSpeed:5,revertInnerRotate:!1,innerRotateSpeed:10,mouseRotatePower:28,mouseRotateInertia:1e3,centerX:.7,centerY:.35,perspective:1e3,size:1.2,framesOverlay:0,gradCenter:{x:.47,y:-.44},gradRadius:.74,gradMiddlePoint:.49,gradColor1:{r:127.5,g:159.375,b:255},gradColor2:{r:102,g:208.7745,b:255},gradColor3:{r:204.3446,g:255,b:178.5},gradPreview:!1,preset:0}];a();let r={firstCubeSize:50,cubesCount:1,backfaceVisible:!1,bgLight:!0,duplicateMethod:"sum",duplicateFactor:.4,framesOverlay:0,perspective:1500,autorotate:!0,autorotateSpeed:25,innerRotateSpeed:15,revertInnerRotate:!1,mouseRotatePower:25,mouseRotateInertia:200,zoom:1,size:1.2,centerX:.5,centerY:.5,...s().gradParams},p=Object.assign({},r);window.pane=new o({container:document.querySelector("[data-pane]")});let l,u,d,h,c,f,m,b,v,g=pane.addFolder({title:"Настройки",expanded:!1});g.addInput(p,"firstCubeSize",{min:1,max:100,step:1}),g.addInput(p,"cubesCount",{min:1,max:50,step:1}),g.addInput(p,"duplicateFactor",{min:.01,max:3,step:.001}),g.addInput(p,"duplicateMethod",{options:["sum","multiply"].reduce((function(t,e){return t[e]=e,t}),{})}),g.addInput(p,"backfaceVisible"),g.addInput(p,"autorotate"),g.addInput(p,"autorotateSpeed",{min:0,max:100,step:1}),g.addInput(p,"revertInnerRotate"),g.addInput(p,"innerRotateSpeed",{min:0,max:100,step:1}),g.addInput(p,"mouseRotatePower",{min:1,max:100,step:1}),g.addInput(p,"mouseRotateInertia",{min:1,max:1e3,step:1}),g.addInput(p,"centerX",{min:0,max:1,step:.01}),g.addInput(p,"centerY",{min:0,max:1,step:.01}),g.addInput(p,"perspective",{min:0,max:3e3,step:1}),g.addInput(p,"size",{min:.1,max:4,step:.1}),g.addInput(p,"framesOverlay",{min:0,max:1,step:.01}),g.addSeparator(),s().createGradControls(g,p),g.addInput({preset:0},"preset",{options:n.reduce(((t,e,i)=>(t["preset "+(i+1)]=i,t)),{})}),n.length&&(Object.assign(p,r,n[0]),pane.refresh()),g.addButton({title:"Copy preset"}).on("click",(()=>navigator.clipboard.writeText(a().default(pane.exportPreset())))),document.querySelector(".box").addEventListener("click",(()=>g.expanded=!1));let w,x,y,I,z,X,R,C,S,Y=0,M=0,P=50,F=50,j=0,k=0,q=0,O=0,T=0,L=0,V=[];function A(t,e,i){this.project=i,this.xo=e[0],this.yo=e[1],this.zo=e[2],this.cube=t}A.prototype.projection=function(){let t=x*(R*this.yo+X*this.xo)-y*this.zo,e=z*(x*this.zo+y*(R*this.yo+X*this.xo))+I*(X*this.yo-R*this.xo),i=I*(x*this.zo+y*(R*this.yo+X*this.xo))-z*(X*this.yo-R*this.xo);this.x=t,this.y=e,this.z=i,this.project&&(i<C&&(C=i),this.visible=p.zoom+i>0,this.X=b*p.centerX+t*(p.perspective/(i+p.zoom)),this.Y=v*p.centerY+e*(p.perspective/(i+p.zoom)))};let D=function(t,e,i){this.cube=t,this.p0=t.points[e[0]],this.p1=t.points[e[1]],this.p2=t.points[e[2]],this.p3=t.points[e[3]],this.normal=new A(this,i,!1)};D.prototype={faceVisible:function(){if(this.p0.visible&&this.p1.visible&&this.p2.visible&&this.p3.visible){if(p.backfaceVisible)return this.visible=!0,!0;if((this.p1.Y-this.p0.Y)/(this.p1.X-this.p0.X)<(this.p2.Y-this.p0.Y)/(this.p2.X-this.p0.X)^this.p0.X<this.p1.X==this.p0.X>this.p2.X)return this.visible=!0,!0}return this.visible=!1,this.distance=-99999,!1},distanceToCamera:function(){let t=.25*(this.p0.x+this.p1.x+this.p2.x+this.p3.x),e=.25*(this.p0.y+this.p1.y+this.p2.y+this.p3.y),i=p.zoom+p.perspective+.25*(this.p0.z+this.p1.z+this.p2.z+this.p3.z);this.distance=Math.sqrt(t*t+e*e+i*i)},draw:function(){let t,e,i,o=t=>{let e=t.reduce(((t,e)=>t+e));-1===V.indexOf(e)?V.push(e):d.globalAlpha=0,d.lineTo(t[2],t[3]),d.globalAlpha=1};d.beginPath(),d.moveTo(this.p0.X,this.p0.Y);let s=[this.p0.X,this.p0.Y,this.p1.X,this.p1.Y];o(s),s=[s[2],s[3],this.p2.X,this.p2.Y],o(s),s=[s[2],s[3],this.p3.X,this.p3.Y],o(s),s=[s[2],s[3],this.p0.X,this.p0.Y],o(s),d.closePath(),this.normal.projection(),t=e=i=256*this.normal.z,d.strokeStyle=S,d.stroke()}};let G=function(t,e,i,o,s,a,n){this.w=n,this.points=[];let r=[[o-n,s-n,a-n],[o+n,s-n,a-n],[o+n,s+n,a-n],[o-n,s+n,a-n],[o-n,s-n,a+n],[o+n,s-n,a+n],[o+n,s+n,a+n],[o-n,s+n,a+n]];for(let t in r)this.points.push(new A(this,r[t],!0));let p=[[0,1,2,3],[0,4,5,1],[3,2,6,7],[0,3,7,4],[1,5,6,2],[5,4,7,6]],l=[[0,0,1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0],[0,0,-1]];this.alpha=1;for(let t in p)c.push(new D(this,p[t],l[t]))},N=function(){b=l.offsetWidth,v=l.offsetHeight;let t=l;for(f=0,m=0;null!=t;t=t.offsetParent)f+=t.offsetLeft,m+=t.offsetTop;u.width=b,u.height=v};function E(){h=[],c=[];let t=p.firstCubeSize;for(let e=0;e<p.cubesCount;e++)h.push(new G(0,0,0,0,0,0,t)),"sum"===p.duplicateMethod?t+=p.duplicateFactor*p.firstCubeSize:"multiply"===p.duplicateMethod&&(t*=p.duplicateFactor)}let W=function(){if(V=[],d.save(),p.gradPreview)d.fillStyle=S,d.fillRect(0,0,u.width,u.height);else{let t=p.bgLight?"255,255,255":"0,0,0";d.fillStyle=`rgba(${t}, ${1-p.framesOverlay})`,d.fillRect(0,0,b,v),C=0;let e,i=0;for(;e=h[i++];){T+=(F-T)/p.mouseRotateInertia,O+=(P-O)/p.mouseRotateInertia,L+=(j-L)/p.mouseRotateInertia;let t=p.revertInnerRotate?p.cubesCount-i+1:i,o=p.innerRotateSpeed/1e5;x=Math.cos(O*o*t),y=Math.sin(O*o*t),I=Math.cos(T*o*t),z=Math.sin(T*o*t),X=Math.cos(L*o*t),R=Math.sin(L*o*t);let s,a=0;for(;s=e.points[a++];)s.projection()}p.autorotate&&(j+=p.autorotateSpeed/10);let o,s=0;for(;o=c[s++];)o.faceVisible()&&o.distanceToCamera();for(c.sort((function(t,e){return e.distance-t.distance})),s=0;(o=c[s++])&&o.visible;)o.draw()}d.restore(),requestAnimationFrame(W)},$=()=>S=s().getActualGradient(u,p),_=()=>p.zoom=p.perspective*p.size,B=()=>{for(let[t,e]of Object.entries(p))!isNaN(parseFloat(e))&&isFinite(e)&&(p[t]=Number.isInteger(e)?parseInt(e):parseFloat(e.toFixed(3)))};window.pane.on("change",(t=>{_(),B(),E(),$()})),l=document.querySelector(".box"),u=document.querySelector("[data-canvas]"),d=u.getContext("2d"),l.ontouchstart=l.onmousedown=function(t){t.target===u&&(t.preventDefault(),l.setCapture&&l.setCapture(),w=!1,k=(void 0!==t.clientX?t.clientX:t.touches[0].clientX)-f,q=(void 0!==t.clientY?t.clientY:t.touches[0].clientY)-m)},l.ontouchmove=l.onmousemove=function(t){t.preventDefault(),Y=(void 0!==t.clientX?t.clientX:t.touches[0].clientX)-f,M=(void 0!==t.clientY?t.clientY:t.touches[0].clientY)-m,P=0+(Y-k)*p.mouseRotatePower/100,F=0-(M-q)*p.mouseRotatePower/100,(Math.abs(Y-k)>10||Math.abs(M-q)>10)&&(w=!0)},l.onmousewheel=function(t){return j+=t.wheelDelta/3,!1},N(),window.addEventListener("resize",N,!1),E(),$(),B(),W(),_(),window.params=p}();
//# sourceMappingURL=index.4ca90124.js.map
